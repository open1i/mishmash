<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>äº‹ä»¶å§”æ‰˜çš„ç¼ºç‚¹ç¤ºä¾‹ï¼ˆå¢å¼ºç‰ˆï¼‰</title>
  <style>
    .container {
      padding: 20px;
      border: 1px solid #ccc;
    }

    .item {
      padding: 10px;
      margin: 5px;
      background-color: #f0f0f0;
      cursor: pointer;
    }

    .item:hover {
      background-color: #ddd;
    }

    .item span {
      color: red;
    }
  </style>
</head>

<body>
  <h2>äº‹ä»¶å§”æ‰˜çš„ç¼ºç‚¹ç¤ºä¾‹ï¼ˆå¢å¼ºç‰ˆï¼‰</h2>

  <div class="container" id="container">
    <div class="item" data-type="button">æŒ‰é’® <span>(åµŒå¥—ç»“æ„)</span></div>
    <div class="item" data-type="link">é“¾æ¥</div>
    <div class="item" data-type="image">å›¾ç‰‡</div>
  </div>

  <hr />
  <button id="add-item">æ·»åŠ å…ƒç´ ï¼ˆç¼ºç‚¹ä¸‰æ¼”ç¤ºï¼‰</button>
  <button id="toggle-mode">åˆ‡æ¢æƒé™ï¼ˆç¼ºç‚¹äº”æ¼”ç¤ºï¼‰</button>

  <script>
    const container = document.getElementById('container');

    let isAdmin = false;

    // ğŸ§  ç¼ºç‚¹äºŒï¼štarget ä¸å‡†ç¡®ï¼Œç‚¹å‡»å­å…ƒç´ å¯èƒ½ä¸ç¬¦åˆé¢„æœŸ
    container.addEventListener('click', function (e) {
      let target = e.target;

      // ä¿®å¤æ–¹å¼ï¼šå‘ä¸ŠæŸ¥æ‰¾æœ€è¿‘çš„ .item çˆ¶çº§
      while (target && !target.classList.contains('item')) {
        target = target.parentElement;
      }

      if (!target) return;

      // â—ï¸æ³¨æ„ï¼šå¦‚æœ target ä¸º null æˆ–ä¸æ˜¯ itemï¼Œä¼šå¯¼è‡´é€»è¾‘é”™è¯¯
      const type = target.dataset.type;

      // ğŸ§  ç¼ºç‚¹äº”ï¼šæƒé™åˆ¤æ–­é€»è¾‘è€¦åˆè¿›äº‹ä»¶å§”æ‰˜å¤„ç†
      if (type === 'button' && !isAdmin) {
        alert('è¯·å…ˆç™»å½•ç®¡ç†å‘˜å†ç‚¹å‡»æŒ‰é’®');
        return;
      }

      alert(`ä½ ç‚¹å‡»äº†ç±»å‹ä¸ºï¼š${type} çš„å…ƒç´ `);
    });

    // ğŸ§  ç¼ºç‚¹ä¸‰ï¼šDOM ç»“æ„é¢‘ç¹å˜åŒ– + å§”æ‰˜äº‹ä»¶æŒç»­å­˜åœ¨ => çŠ¶æ€æ··ä¹±
    document.getElementById('add-item').addEventListener('click', () => {
      const newItem = document.createElement('div');
      newItem.className = 'item';
      newItem.dataset.type = 'button';
      newItem.innerHTML = 'æ–°æŒ‰é’® <span>(åŠ¨æ€åˆ›å»º)</span>';
      container.appendChild(newItem);
    });

    // ğŸ§  ç¼ºç‚¹å››ï¼šæ‹–æ‹½åœºæ™¯ä¸­äº‹ä»¶å¯¹è±¡ä¸ç¨³å®š
    // æ¨¡æ‹Ÿç®€å•çš„æ‹–æ‹½é€»è¾‘ï¼šç»™ item æ·»åŠ æ‹–æ‹½äº‹ä»¶
    // è¿™ç§åœºæ™¯ä¸æ¨èä½¿ç”¨å§”æ‰˜ï¼Œå› ä¸º drag äº‹ä»¶è¡Œä¸ºæœ¬èº«å°±ä¸å†’æ³¡
    container.addEventListener('dragstart', (e) => {
      console.log('dragstart target:', e.target);
    });

    // ç›´æ¥ç»™æ¯ä¸ª item ç»‘å®šæ›´åˆé€‚
    function setupDraggableItems() {
      const items = container.querySelectorAll('.item');
      items.forEach(item => {
        item.setAttribute('draggable', 'true');
      });
    }

    setupDraggableItems();

    // ğŸ§  ç¼ºç‚¹äº”ï¼šç»†ç²’åº¦æƒé™æ§åˆ¶æ··å…¥å§”æ‰˜é€»è¾‘ï¼Œåˆ¤æ–­å¤æ‚ã€èŒè´£ä¸æ¸…
    document.getElementById('toggle-mode').addEventListener('click', () => {
      isAdmin = !isAdmin;
      alert(isAdmin ? 'ç®¡ç†å‘˜æ¨¡å¼å·²å¯ç”¨' : 'ç®¡ç†å‘˜æ¨¡å¼å·²å…³é—­');
    });
  </script>

  <hr />
  <p><strong>è¯´æ˜ï¼š</strong></p>
  <ul>
    <li>ç‚¹å‡»æŒ‰é’®â€œæ·»åŠ å…ƒç´ â€åï¼ŒåŠ¨æ€æ·»åŠ  .item èŠ‚ç‚¹ï¼Œäº‹ä»¶å§”æ‰˜ä»ç”Ÿæ•ˆï¼ˆå±•ç¤ºç¼ºç‚¹ä¸‰ï¼‰</li>
    <li>ç‚¹å‡»â€œ.itemâ€å­å…ƒç´ ä¸­çš„ spanï¼ˆçº¢è‰²æ–‡æœ¬ï¼‰æ—¶ï¼Œtarget ä¼šæ˜¯ span è€Œé itemï¼ˆå±•ç¤ºç¼ºç‚¹äºŒï¼‰</li>
    <li>è®¾ç½® draggable å±æ€§ï¼Œå±•ç¤ºäº‹ä»¶å§”æ‰˜ä¸é€‚åˆ drag ç±»å‹äº‹ä»¶ï¼ˆç¼ºç‚¹å››ï¼‰</li>
    <li>ç‚¹å‡»â€œåˆ‡æ¢æƒé™â€æŒ‰é’®åˆ‡æ¢ç®¡ç†å‘˜æ¨¡å¼ï¼Œå†ç‚¹å‡»â€œæŒ‰é’®â€éªŒè¯æƒé™æ§åˆ¶é—®é¢˜ï¼ˆç¼ºç‚¹äº”ï¼‰</li>
  </ul>

</body>

</html>